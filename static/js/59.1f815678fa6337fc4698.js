webpackJsonp([59],{"6l5L":function(n,e,a){var t=a("uXhL");"string"==typeof t&&(t=[[n.i,t,""]]),t.locals&&(n.exports=t.locals);a("FIqI")("4c509548",t,!0,{})},HR8b:function(n,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=a("3cXf"),i=a.n(t),o=a("vbKY"),r=a("TVG1"),p={data:function(){return{global:o.a.data,logoImgUrl:"",clubName:"",payBtnStatusCls:"disabled",payBtnText:"确认支付",showInputTip:!0,payMoney:"",openId:r.a.localStorage("_qrpay_user_open_id")||"",clubId:"",payAuthCode:"",paramData:"",oldMoney:"",payRequestObj:null}},created:function(){var n=this,e=n.global,a=e.currPage.query;if(document.title="支付",n.clubId=a.clubId||e.clubId,n.clubId){n.payAuthCode=a.payAuthCode||e.authCode;var t=r.a.localStorage("con-qrpay-param");t&&(n.paramData=JSON.parse(t)),e.userAgent.isWX?(!n.openId||n.openId.length<10)&&(+new Date-(a._t||0)>2400||!n.payAuthCode?o.a.getOauthCode("9358","confirm-qrpay","base"):o.a.getOpenId({authCode:n.payAuthCode,state:"confirm-qrpay"}).then(function(e){n.openId=e,r.a.localStorage("_qrpay_user_open_id",e),n.init()},function(n){r.a.tipShow(n||"未能获取OpenId！")})):n.init()}else r.a.tipShow(e.visitError),n.$router.back()},methods:{init:function(){var n=this,e=n.global;n.$http.get("../api/v2/club/{clubId}/clubName",{params:{clubId:n.clubId}}).then(function(a){(a=a.body).name&&(n.logoImgUrl=a.logo,n.clubName=a.name),n.paramData&&(r.a.removeLocalStorage("con-recharge-param"),n.payMoney=n.paramData.amount,n.payBtnStatusCls="",n.doClickPayBtn()),e.loading=!1})},doClickClearBtn:function(){this.payMoney="",this.oldMoney="",this.showInputTip=!0},onFocusOfInput:function(){this.showInputTip=!1},onBlurOfInput:function(){""==this.payMoney&&(this.showInputTip=!0)},onInputOfPayMoney:function(){if(""==this.payMoney)this.oldMoney.length>1?this.payMoney=this.oldMoney:(this.oldMoney="",this.payBtnStatusCls="disabled");else{this.payMoney=this.payMoney+"";var n=this.payMoney.match(/\./g);n&&n.length>1&&(this.payMoney=this.payMoney.slice(0,-1)),/^([1-9][0-9]*)$/g.test(this.payMoney)?this.oldMoney=this.payMoney:this.payMoney=this.oldMoney,this.payBtnStatusCls=""}},doClickPayBtn:function(){var n=this;if(!n.global.userAgent.isWX)return r.a.tipShow("只能通过微信进行支付！");if("disabled"!=n.payBtnStatusCls)if("processing"==n.payBtnStatusCls)r.a.tipShow("正在处理中，请稍候...");else{n.payBtnStatusCls="processing",n.payBtnText="支付...";var e={businessChannel:"link",amount:parseFloat(n.payMoney),clubId:n.clubId||"",tradeChannel:"wx",openId:n.openId};n.$http.post("../api/v2/wx/pay/consume/save",e).then(function(a){200==(a=a.body).statusCode?(e.payToken=a.respData.token,n.payRequestObj=JSON.parse(a.respData.payInfo),o.a.wxJsBridgeReady(function(){n.onBridgeReady(e)})):"935801"==a.statusCode?(r.a.localStorage("con-qrpay-param",i()(e)),o.a.getOauthCode("9358","confirm-qrpay","base")):(n.payBtnStatusCls="",n.payBtnText="确认支付",r.a.tipShow(a.msg||"支付失败！"))},function(){n.payBtnStatusCls="",n.payBtnText="确认支付",r.a.tipShow("支付失败！")})}},onBridgeReady:function(n){var e=this,a=e.payRequestObj;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:a.appId,timeStamp:a.timeStamp+"",nonceStr:a.nonceStr,package:a.package,signType:a.signType,paySign:a.paySign},function(a){e.payBtnStatusCls="",e.payBtnText="确认支付",a.err_msg.indexOf("ok")>=0?(r.a.tipShow("支付成功！"),e.$router.push({name:"qrPayComplete",query:{clubId:n.clubId,money:n.amount,payToken:n.payToken}})):r.a.tipShow("未能成功支付！")})}}},d={render:function(){var n=this,e=n.$createElement,a=n._self._c||e;return a("div",{staticClass:"page",attrs:{id:"qrpay-page"}},[a("div",{staticClass:"club-info"},[a("div",[a("div",{style:{backgroundImage:"url("+(n.logoImgUrl||n.global.defaultClubLogo)+")"}}),n._v(" "),a("p",[n._v(n._s(n.clubName))])])]),n._v(" "),a("div",{staticClass:"money-info"},[a("div",[n._v("消费金额")]),n._v(" "),a("div",[a("span",[n._v("￥")]),n._v(" "),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:n.payMoney,expression:"payMoney"}],attrs:{type:"number",pattern:"[0-9]*"},domProps:{value:n.payMoney},on:{focus:function(e){n.onFocusOfInput()},blur:function(e){n.onBlurOfInput()},input:[function(e){e.target.composing||(n.payMoney=e.target.value)},function(e){n.onInputOfPayMoney()}]}}),n._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:n.showInputTip,expression:"showInputTip"}]},[n._v("请询问服务员后输入")]),n._v(" "),a("i",{on:{click:function(e){n.doClickClearBtn()}}})])])]),n._v(" "),a("div",{staticClass:"pay-btn",class:n.payBtnStatusCls,on:{click:function(e){n.doClickPayBtn()}}},[n._v(n._s(n.payBtnText))])])},staticRenderFns:[]};var l=a("Z0/y")(p,d,!1,function(n){a("6l5L")},null,null);e.default=l.exports},nfkV:function(n,e){n.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODEzM0I5QUIyRDRGMTFFNkE5RUJDRjZDODk4QzIzOUIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODEzM0I5QUMyRDRGMTFFNkE5RUJDRjZDODk4QzIzOUIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpERTIyQTJBODJENEUxMUU2QTlFQkNGNkM4OThDMjM5QiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4MTMzQjlBQTJENEYxMUU2QTlFQkNGNkM4OThDMjM5QiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgTBRlwAAAOlSURBVHjazJhPSBVRFMbvjLN46UJI3ITwdmnaQhLEpNVDtEW4VYSepAnpKmiRgrSowDZtNTBFC0K34UJFXUmpILyFWrYTzI0ouNBcpPYd+SamYebOv/ekCx8+3pt7zs9775x7zjEWFxdVxGFA9VAT1ABVQTegYv5+Au1B36EVaAFagy68jGUyGU8nVgSgMqgP6obS/O4Q2oJWoSN+V8rfG6EH0GtoBxqDhqGDMM7CgKWgZ9AAVAJ94+cZaNNvJbiyNYTLQi+h59AQ9BY61Tk1A6BqoRz/a4G4T2dvoA0NlOJvG3y2hnM3aStH27HA2nhGKqAe6C40FwCjg5yjjR7aXKGPSGC90BTPRh30HjpXycc5bdXR9tTS0lJvWLA2HlJ5k+5B2yr/Y5u2xccw4NqCwGTfJ6EfPLT7qnBjnz7E1yTgav3AUty+31BrgaGccK30Kdua8gKTkFAJPS3Q9imfALtNn5Vk+AesjLFJ9nxcE5c6oaIY/mXOE83ccfoewKqVOcH6GDxfaN4+gZqAPkSEK+KcEYYKr1U7p+8SslyCGbxmJKLPaxx8hD5BHRHgbKgOzh3VPDtPhm6smmHyQk7TgC54nvFqCQvnhsrSht9Zu+DzwlJvMktQvPuCRli4SFCOYTM0WUxdDnmPqQhwio6Vy3FcKEUGYWkwmU9tRbwD/VYuCZS9ncJSZTHJW40RArxWTsWFcgy5Q+9YzDyPYsZHL7gkUIosxab6T4fFHL005nz3mfJ7IaIMYTmxWDik8wCVdZ2zuHDCsmexmmnkDXCRAOrMARMLTiI+/lRDX0ymuNeZlyeFinNDOEcNWVZM1n2KSVtSqKRwNsOCyXRjh4aMfN19UeG4jVmyrJk8V1KM3oKaNY4exgiebrgezbPNZBiTG8COY1J8HLMo9YttUgs8ivGm2XC9fmkPVsuk72Oy/IU4YIUsKVCXpjaciBmbZM47zdwu+h7Cal22EAxHUyXFCrmCdd9V5f2S669Du1KlAezUXYzIF+28DT5D5VcAVU5f4rPdhvKqK3PM7W8yaSsvMNQMfXUCKhdUiU+zIJA9X+ZSF2L7lumjD1DTYXsXI9zWNPf/cYjOUJhh0tY6bcv2jUTt9kwz7d7la/4VagkIwrouZAttjNJmA33E6o/ZfaxB3mOzzMv7odsBkAaf6eecWdoYdPTd/CdH6MHqWp07Hq3Oal7IStfqzEcPVgy+YkfQ3RyWuHeNz/2CfkrqEqY57Df+CDAAE98wR9NDCE4AAAAASUVORK5CYII="},uXhL:function(n,e,a){var t=a("JLGU");(n.exports=a("XLS9")(!1)).push([n.i,'\n.clearfix {\n  display: inline-block;\n}\n.clearfix:after {\n    display: block;\n    content: ".";\n    height: 0;\n    line-height: 0;\n    clear: both;\n    visibility: hidden;\n}\n@media (-webkit-min-device-pixel-ratio: 1.5), (min-device-pixel-ratio: 1.5) {\n.border-1px::after {\n    -webkit-transform: scaleY(0.7);\n    transform: scaleY(0.7);\n}\n}\n@media (-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2) {\n.border-1px::after {\n    -webkit-transform: scaleY(0.5);\n    transform: scaleY(0.5);\n}\n}\ndiv#qrpay-page div.club-info {\n  padding: 1.667rem 0 1.444rem;\n  text-align: center;\n}\ndiv#qrpay-page div.club-info > div {\n    display: inline-block;\n    text-align: center;\n}\ndiv#qrpay-page div.club-info > div > div {\n      display: inline-block;\n      width: 4.111rem;\n      height: 4.111rem;\n      border-radius: 50%;\n      margin-bottom: .833rem;\n      background-position: center;\n      background-size: 4.111rem 4.111rem;\n      background-repeat: no-repeat;\n}\ndiv#qrpay-page div.club-info > div > p {\n      margin: 0;\n      line-height: 1;\n      font-size: .889rem;\n      color: #424242;\n}\ndiv#qrpay-page div.money-info {\n  background-color: #fff;\n  padding: 1rem .667rem;\n}\ndiv#qrpay-page div.money-info > div {\n    line-height: 1;\n}\ndiv#qrpay-page div.money-info > div:nth-of-type(1) {\n      color: #424242;\n      font-size: .778rem;\n}\ndiv#qrpay-page div.money-info > div:nth-of-type(2) {\n      position: relative;\n      line-height: 1;\n      margin-top: 1.5rem;\n}\ndiv#qrpay-page div.money-info > div:nth-of-type(2) > span {\n        position: absolute;\n        font-size: 1.444rem;\n}\ndiv#qrpay-page div.money-info > div:nth-of-type(2) > div {\n        margin-left: 1.5rem;\n        position: relative;\n        border-bottom: 1px solid #e0e0e0;\n}\ndiv#qrpay-page div.money-info > div:nth-of-type(2) > div > input {\n          background-color: transparent;\n          color: #000;\n          font-size: 1.889rem;\n          padding: 0 0 0 1rem;\n          border: 0;\n          outline: none;\n          -webkit-tap-highlight-color: rgba(255, 0, 0, 0);\n          resize: none;\n          width: 15rem;\n}\ndiv#qrpay-page div.money-info > div:nth-of-type(2) > div > span {\n          position: absolute;\n          left: 1rem;\n          top: 50%;\n          -webkit-transform: translate(0, -50%);\n                  transform: translate(0, -50%);\n          font-size: .778rem;\n          color: #ccc;\n          pointer-events: none;\n}\ndiv#qrpay-page div.money-info > div:nth-of-type(2) > div > i {\n          display: inline-block;\n          position: absolute;\n          width: 1.056rem;\n          height: 1.056rem;\n          right: 0;\n          top: 50%;\n          -webkit-transform: translate(0, -50%);\n                  transform: translate(0, -50%);\n          background-size: 1.056rem 1.056rem;\n          background-image: url('+t(a("nfkV"))+");\n          background-repeat: no-repeat;\n}\ndiv#qrpay-page div.pay-btn {\n  margin: .889rem .667rem;\n  background-color: #fb5549;\n  color: #fff;\n  text-align: center;\n  height: 2.444rem;\n  line-height: 2.444rem;\n  font-size: .889rem;\n  border-radius: .222rem;\n}\ndiv#qrpay-page div.pay-btn.disabled {\n    background-color: #e0e0e0;\n    color: #bdbdbd;\n}\ndiv#qrpay-page div.pay-btn.processing {\n    color: #bdbdbd;\n    background: #e0e0e0 url("+t(a("qbkd"))+") no-repeat 30% 45%;\n}\n",""])}});