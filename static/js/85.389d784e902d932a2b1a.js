webpackJsonp([85],{UNs8:function(e,t,r){var n=r("u1Ax");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);r("FIqI")("7bd8aee8",n,!0,{})},Wfjs:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("3cXf"),i=r.n(n),a=r("vbKY"),o=r("TVG1"),s=r("wy9b"),d=r.n(s),l=r("bg9g"),c=(r("4IlM"),{filters:{MoneyFilter:l.a},data:function(){return{global:a.a.data,isPopModal:!1,currTab:1,pageSize:10,isQueryAll:!0,dataArr:[],qrCodeImgSrc:null,qrCode:"",qrCodeTitle:"",showPopShare:!1,timer:null}},mounted:function(){var e=this,t=e.global,r=t.currPage.query,n=o.a.sessionStorage,i=o.a.removeSessionStorage,a=[];e.isQueryAll="club"!=t.pageMode||"true"==r.all,e.currTab=r.tab||0;for(var s=0;s<2;s++)a.push({dataList:[],dataIndex:{},currPage:0,showDataLoadTip:!1,showFinishLoadTip:!1,isDataAddEnd:!1,isAddData:!1,hasLoadData:!1});e.dataArr=a;var d=n("group_buy_data"),l=n("group_buy_tab");if(l==e.currTab&&d){var c=e.dataArr[l];c.dataList=JSON.parse(d),c.currPage=n("group_buy_page")-0,c.dataIndex=JSON.parse(n("group_buy_set")),c.isDataAddEnd="true"==n("group_buy_end"),c.showFinishLoadTip="true"==n("group_buy_finish"),c.hasLoadData=!0;var u=n("group_buy_top");e.$nextTick(function(){var r=e.$refs["listEle"+l][0];setTimeout(function(){r.scrollTop=u,t.loading=!1,e.doTimerCount()},100)})}else e.queryRecord(),t.loading=!1;d&&(i("group_buy_data"),i("group_buy_tab"),i("group_buy_page"),i("group_buy_set"),i("group_buy_end"),i("group_buy_finish"),i("group_buy_top"))},methods:{doClickShare:function(e,t){t.stopPropagation();var r=this,n=r.global;r.showPopShare=!0,n.userAgent.isWX&&a.a.shareConfig({title:e.activityName,desc:"没有大动作，哪敢惊动你！"+e.itemName+"，原价"+(e.itemPrice/100).toFixed(2)+"，现仅需"+(e.price/100).toFixed(2)+"，立刻点击参与！",link:n.prefixPathname+"?#/"+e.clubId+"/groupBuyActShare?id="+e.activityId+"&userId="+n.userId+"&groupId="+e.openGroupId,imgUrl:e.itemImageUrl,success:function(){r.$http.post("../api/v2/user/group/buy/update/share/count",{activityId:e.activityId,shareUserId:n.userId})}},"groupBuyRecords-"+e.id)},switchMenuType:function(e){this.currTab!=e&&(this.dataArr[e].hasLoadData||this.queryRecord(e,1),this.currTab=e,this.$router.replace({name:"groupBuyRecords",query:{tab:e,all:this.isQueryAll}}))},doCloseModal:function(e){this[e]=!1},doClickPopWrap:function(e){e.stopPropagation()},doViewDetail:function(e){this.cacheSave(),"already"==e.type?this.$router.push({name:"groupBuyRecordDetail",query:{id:e.id,clubId:e.clubId}}):this.$router.push({name:"groupBuyActShare",query:{id:e.activityId,clubId:e.clubId,groupId:e.openGroupId}})},doPopQrcode:function(e,t){t.stopPropagation();this.qrCodeImgSrc=jrQrcode.getQrBase64(e.couponNo,{padding:0}),this.qrCodeTitle=e.activityName,this.qrCode=o.a.spaceFormat(e.couponNo),this.isPopModal=!0},queryRecord:function(e,t){var r=this,n=r.global;e=(void 0!=e?e:r.currTab)-0;var i=r.dataArr[e];i.isAddData||(i.isAddData=!0,t=t||i.currPage+1,i.showDataLoadTip=!0,i.showFinishLoadTip=!1,i.isDataAddEnd=!1,r.$http.get("../api/v2/user/group/buy/record/list",{params:{page:t,pageSize:r.pageSize,clubId:r.isQueryAll?"":n.clubId,isCompleted:0==e}}).then(function(a){(a=a.body)?(a="200"!=a.statusCode?[]:a.respData,i.hasLoadData||(i.hasLoadData=!0),r.doHandlerData(a,i,e),a.length<r.pageSize&&(i.isDataAddEnd=!0,1==t&&0==a.length||(i.showFinishLoadTip=!0)),i.currPage=t,i.isAddData=!1,i.showDataLoadTip=!1,d.a.set(r.dataArr,e,i),r.doTimerCount()):o.a.tipShow(n.loadError)},function(){o.a.tipShow(n.loadError)}))},doHandlerListScroll:function(){var e=this.dataArr[this.currTab],t=this.$refs["listEle"+this.currTab][0];!e.isDataAddEnd&&t.scrollTop+1.4*t.clientHeight>t.scrollHeight&&this.queryRecord()},doHandlerData:function(e,t,r){for(var n=void 0,i=void 0,a=0;a<e.length;a++)(n=e[a]).type=0==r?"already":"processing",1==r&&n.endTime&&(n.timeStr=this.getGroupEndTime(n.endTime)),void 0==(i=t.dataIndex[n.clubId])&&(i=t.dataList.length,t.dataIndex[n.clubId]=i,t.dataList.push({clubName:n.clubName,list:[],isClosed:!1})),t.dataList[i].list.push(n)},doTimerCount:function(){var e=this,t=void 0,r=void 0,n=void 0,i=void 0,a=void 0,o=void 0;e.timer=setInterval(function(){if(a=e.dataArr[1].dataList,o=[],a.length)for(t=0;t<a.length;t++){for(n=a[t],r=0;r<n.list.length;r++)(i=n.list[r]).endTime&&(i.timeStr=e.getGroupEndTime(i.endTime));o.push(n)}e.dataArr[1].dataList=o},1e3)},getGroupEndTime:function(e){var t=0,r=0,n=0,i=0,a=0,s=e-+new Date,d=Math.floor,l=o.a.paddingTime;return s<0?"":(n=d((a=s/1e3)%60),r=d(a/60%60),t=d(a/3600%24),0==(i=d(a/3600/24))?l(t)+":"+l(r)+":"+l(n):i+"天"+l(t)+":"+l(r)+":"+l(n))},cacheSave:function(){var e=o.a.sessionStorage,t=this.dataArr[this.currTab],r=this.$refs["listEle"+this.currTab][0];e("group_buy_data",i()(t.dataList)),e("group_buy_tab",this.currTab),e("group_buy_page",t.currPage),e("group_buy_set",i()(t.dataIndex)),e("group_buy_end",t.isDataAddEnd),e("group_buy_finish",t.showFinishLoadTip),e("group_buy_top",r.scrollTop)},doSwitchClose:function(e,t,r){var n=this.dataArr[r];e.isClosed=!e.isClosed,d.a.set(n.dataList,t,e)}},beforeDestroy:function(){this.timer&&clearInterval(this.timer)}}),u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page",attrs:{id:"group-buy-records-page"}},[r("div",{staticClass:"switch-menu"},[r("div",{class:{active:0==e.currTab},on:{click:function(t){e.switchMenuType(0)}}},[e._v("已成团")]),e._v(" "),r("div",{class:{active:1==e.currTab},on:{click:function(t){e.switchMenuType(1)}}},[e._v("进行中")])]),e._v(" "),r("div",{staticClass:"wrap",class:{active:1==e.currTab},style:{height:e.global.winHeight-2.667*e.global.winScale*16+"px"}},e._l(e.dataArr,function(t,n){return r("div",{key:n,ref:"listEle"+n,refInFor:!0,staticClass:"list item-content",style:{height:e.global.winHeight-2.667*e.global.winScale*16+"px"},on:{scroll:function(t){e.doHandlerListScroll()}}},[e._l(t.dataList,function(t,i){return r("div",{staticClass:"list-item"},[e.isQueryAll?r("div",{staticClass:"header",class:{first:0==i}},[e._v(e._s(t.clubName)),r("div",{class:{closed:t.isClosed},on:{click:function(r){e.doSwitchClose(t,i,n)}}},[e._v(e._s(t.isClosed?"展开":"收起"))])]):e._e(),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.isClosed,expression:"!singleClubData.isClosed"}],staticClass:"list-wrap"},e._l(t.list,function(t){return r("div",{key:t.id,staticClass:"item",class:t.type,on:{click:function(r){e.doViewDetail(t)}}},[r("div",[r("h3",[e._v(e._s(t.activityName))]),e._v(" "),r("div",[r("label",[e._v("拼团价：")]),r("strong",[e._v(e._s(e._f("MoneyFilter")(t.price)))]),r("span",[e._v("元")])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:"already"!=t.type,expression:"itemObj.type!='already'"}]},[r("label",[e._v("拼团人数：")]),r("span",[e._v(e._s(t.obtainedCount||t.personalCount)+"/"+e._s(t.personalCount))])]),e._v(" "),"already"==t.type?r("div",[r("label",[e._v("有效时间：")]),r("span",[e._v(e._s(t.couponPeriod))])]):r("div",[t.endTime&&t.timeStr?[r("label",[e._v("剩余时间：")]),r("span",[e._v(e._s(t.timeStr))])]:e._e()],2),e._v(" "),"already"==t.type?r("div",[e._v(e._s(t.verifyStatus))]):e._e()]),e._v(" "),"already"==t.type&&"可用"==t.verifyStatus?r("div",{on:{click:function(r){e.doPopQrcode(t,r)}}},[e._v("立即使用")]):e._e()])}))])}),e._v(" "),r("div",{staticClass:"data-load-tip",class:{none:!t.showDataLoadTip}},[r("div",[e._v("加载数据")])]),e._v(" "),r("div",{staticClass:"finish-load-tip border-top",class:{none:!t.showFinishLoadTip}},[r("div",[e._v("已经加载全部数据")])]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.showDataLoadTip&&!t.showFinishLoadTip&&!t.isAddData&&t.dataList.length>0,expression:"!dataObj.showDataLoadTip && !dataObj.showFinishLoadTip && !dataObj.isAddData && dataObj.dataList.length>0"}],staticClass:"load-more",on:{click:function(t){e.queryRecord()}}},[e._v("加载更多")]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:0==t.dataList.length&&!t.isAddData,expression:"dataObj.dataList.length==0 && !dataObj.isAddData"}],staticClass:"nullData"},[r("div",{directives:[{name:"show",rawName:"v-show",value:!e.global.loading,expression:"!global.loading"}]}),e._v(" "),r("div",[e._v(e._s(e.global.loading?"数据加载中...":"暂无内容..."))])])],2)})),e._v(" "),r("div",{staticClass:"pop-modal",class:{active:e.isPopModal},on:{click:function(t){e.doCloseModal("isPopModal")}}},[r("div",{staticClass:"center-wrap",on:{click:function(t){e.doClickPopWrap(t)}}},[r("h3",[e._v(e._s(e.qrCodeTitle))]),e._v(" "),e.qrCodeImgSrc?r("img",{attrs:{src:e.qrCodeImgSrc,alt:"二维码"}}):e._e(),e._v(" "),r("div",[e._v(e._s(e.qrCode))])])])])},staticRenderFns:[]};var p=r("Z0/y")(c,u,!1,function(e){r("UNs8")},null,null);t.default=p.exports},u1Ax:function(e,t,r){(e.exports=r("XLS9")(!1)).push([e.i,'\n.clearfix {\n  display: inline-block;\n}\n.clearfix:after {\n    display: block;\n    content: ".";\n    height: 0;\n    line-height: 0;\n    clear: both;\n    visibility: hidden;\n}\n@media (-webkit-min-device-pixel-ratio: 1.5), (min-device-pixel-ratio: 1.5) {\n.border-1px::after {\n    -webkit-transform: scaleY(0.7);\n    transform: scaleY(0.7);\n}\n}\n@media (-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2) {\n.border-1px::after {\n    -webkit-transform: scaleY(0.5);\n    transform: scaleY(0.5);\n}\n}\n#group-buy-records-page .switch-menu {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  height: 2.66667rem;\n  background: #fff;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  border-bottom: 1px solid #e0e0e0;\n}\n#group-buy-records-page .switch-menu > div {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    height: 100%;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n    width: 4.52778rem;\n    font-size: 0.88889rem;\n    color: #666;\n    border-bottom: 2px solid #fff;\n}\n#group-buy-records-page .switch-menu > div.active {\n      color: #f66;\n      border-bottom-color: #f66;\n}\n#group-buy-records-page .switch-menu > div:nth-of-type(1) {\n      margin-right: 2.77778rem;\n}\n#group-buy-records-page .wrap {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  width: 40rem;\n  -webkit-transition: -webkit-transform 0.3s ease-out;\n  transition: -webkit-transform 0.3s ease-out;\n  transition: transform 0.3s ease-out;\n  transition: transform 0.3s ease-out, -webkit-transform 0.3s ease-out;\n  -webkit-transform: translateX(0);\n          transform: translateX(0);\n}\n#group-buy-records-page .wrap > div {\n    width: 20rem;\n    height: 100%;\n    overflow-y: auto;\n}\n#group-buy-records-page .wrap.active {\n    -webkit-transform: translateX(-50%);\n            transform: translateX(-50%);\n}\n#group-buy-records-page .item {\n  padding-top: 0.44444rem;\n}\n#group-buy-records-page .item > div:nth-of-type(1) {\n    position: relative;\n    padding: 0.33333rem 0.66667rem 0.5rem 1.33333rem;\n    background: #fff;\n    border-bottom: 1px solid #e0e0e0;\n}\n#group-buy-records-page .item > div:nth-of-type(1) > h3 {\n      padding-top: 0.33333rem;\n      font-size: 1rem;\n      color: #212121;\n      margin-bottom: 0.27778rem;\n      width: 16.4rem;\n}\n#group-buy-records-page .item > div:nth-of-type(1) > div {\n      line-height: 1.4;\n}\n#group-buy-records-page .item > div:nth-of-type(1) > div label {\n        font-size: 0.77778rem;\n        color: #666;\n        display: inline-block;\n        text-align: left;\n        width: 4.11111rem;\n}\n#group-buy-records-page .item > div:nth-of-type(1) > div span {\n        font-size: 0.77778rem;\n        color: #333;\n}\n#group-buy-records-page .item > div:nth-of-type(1) > div:nth-of-type(1) > strong {\n        font-size: 0.88889rem;\n        color: #f66;\n        font-weight: normal;\n}\n#group-buy-records-page .item > div:nth-of-type(1) > div:nth-of-type(1) > span {\n        font-size: 0.72222rem;\n        color: #757575;\n        margin-left: 0.13889rem;\n}\n#group-buy-records-page .item > div:nth-of-type(2) {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    height: 1.66667rem;\n    color: #1e78d5;\n    font-size: 0.77778rem;\n    text-decoration: underline;\n    background: #fff;\n}\n#group-buy-records-page .item.already > div > div:nth-of-type(4) {\n    position: absolute;\n    right: 0.66667rem;\n    top: 0.83333rem;\n    font-size: 0.77778rem;\n    color: #f66;\n}\n#group-buy-records-page .item.processing > div > div:nth-of-type(2) > span {\n    color: #f66;\n}\n#group-buy-records-page .item.processing > div > div:nth-of-type(3) > span {\n    color: #333;\n}\n#group-buy-records-page .center-wrap {\n  background: #fff;\n  width: 15.94444rem;\n  width: 16.16667rem;\n  border-radius: 0.27778rem;\n}\n#group-buy-records-page .center-wrap > h3 {\n    text-align: center;\n    font-size: 1.16667rem;\n    color: #212121;\n    line-height: 2.5rem;\n}\n#group-buy-records-page .center-wrap > img {\n    display: block;\n    width: 11.5rem;\n    height: 11.5rem;\n    line-height: 11.5rem;\n    text-align: center;\n    margin: 0 auto;\n    font-size: 0.88889rem;\n}\n#group-buy-records-page .center-wrap > div {\n    line-height: 2.16667rem;\n    text-align: center;\n    font-size: 1rem;\n    color: #212121;\n}\n#group-buy-records-page .load-more {\n  text-align: center;\n  line-height: 1.11111rem;\n  font-size: 0.77778rem;\n  color: #666;\n  text-decoration: underline;\n}\n#group-buy-records-page .list-item {\n  padding-bottom: 0.722rem;\n}\n#group-buy-records-page .list-item .header {\n    height: 1.805rem;\n    line-height: 1.805rem;\n    background-color: #e6e6e6;\n    font-size: 0.889rem;\n    color: #666;\n    text-indent: 0.611rem;\n    border-top: 1px solid #ccc;\n    border-bottom: 1px solid #ccc;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n#group-buy-records-page .list-item .header.first {\n      border-top: 0;\n}\n#group-buy-records-page .list-item .header > div {\n      float: right;\n      font-size: 0.778rem;\n      text-decoration: underline;\n      margin-right: 0.44444rem;\n}\n#group-buy-records-page .list-item .header > div:after {\n        content: "";\n        display: inline-block;\n        width: 0.42rem;\n        height: 0.42rem;\n        border-left: 1px solid #999;\n        border-bottom: 1px solid #999;\n        margin-left: 0.244rem;\n        -webkit-transition: -webkit-transform 0.3s;\n        transition: -webkit-transform 0.3s;\n        transition: transform 0.3s;\n        transition: transform 0.3s, -webkit-transform 0.3s;\n        -webkit-transform: rotate(135deg);\n        transform: rotate(135deg);\n}\n#group-buy-records-page .list-item .header > div.closed:after {\n        margin-top: -0.3rem;\n        vertical-align: middle;\n        -webkit-transform: rotate(-45deg);\n        transform: rotate(-45deg);\n}\n',""])}});